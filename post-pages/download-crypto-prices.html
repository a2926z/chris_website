<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retrieve Current Cryptocurrency Prices with Coinmarketcap API and Excel</title>

    <!-- Meta description -->
    <meta name="description" content="Interested in tracking your cryptocurrency investments? Learn how to retrieve current cryptocurrency prices using 
    the Coinmarketcap API and Excel spreadsheet. With just three essential pieces of information, you can access numerous cryptocurrency prices for free. 
    Follow this guide to obtain your API key, retrieve the data, and save it to an Excel file.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=EB+Garamond&family=IBM+Plex+Sans&family=Source+Sans+Pro&display=swap"
        rel="stylesheet">

    <!-- CSS stylesheets -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/styles.css">

    <!-- Bootstrap scripts -->
    <!-- jQuery was identified as thread from lighthouse so was muted and everything so far works fine. Activated again as now Chrome 
    displays an error -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

    <link rel="icon" href="../favicon33.ico">

    <!-- script for navbar -->
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>

    <!-- og metatag for fb -->
    <meta property="og:title"
        content="Retrieve Current Cryptocurrency Prices with Coinmarketcap API and Excel" />
    <meta property="og:description" content="Interested in tracking your cryptocurrency investments? Learn how to retrieve current cryptocurrency prices 
    using the Coinmarketcap API and Excel spreadsheet. With just three essential pieces of information, you can access numerous cryptocurrency prices for 
    free. Follow this guide to obtain your API key, retrieve the data, and save it to an Excel file." />
    <meta property="og:image" content="https://a2926z.github.io/chris_website/post-images/coinmarketcap1.webp" />

    <!-- Google analytics script -->
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3SH07R6XXT"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-3SH07R6XXT');
    </script>
</head>

<body class="post-body">
    <!--Navigation bar-->
    <div id="nav-placeholder">

    </div>

    <script>
        $(function () {
            $("#nav-placeholder").load("../nav.html");
        });
    </script>
    <!--end of Navigation bar-->

    <div class="post">
        <div class="post-title-header">
            <h1 class="post-title">Retrieve Current Cryptocurrency Prices with Coinmarketcap API and Excel
            </h1>
        </div>

        <img src="../post-images/coinmarketcap1.webp" class="post-img-top">

        <h2 class="post-h2">
            Interested in tracking your cryptocurrency investments? Learn how to retrieve current cryptocurrency prices
            using the Coinmarketcap API and Excel spreadsheet. With just three essential pieces of information, you can
            access numerous cryptocurrency prices for free. Follow this guide to obtain your API key, retrieve the data,
            and save it to an Excel file.
        </h2>
        <br>


        <p class="post-text">
          <b>If you're involved</b>   in cryptocurrency, and especially if you've chosen to buy some, then you might be very
            interested in this article. There's a financial saying that goes: "Never ignore a trend, it could make you
            rich and sometimes very wealthy." Some of us have chosen not to ignore the trend and have bought some
            (always with money that we have surplus and don't need***).
        </p>
        <br>

        <p class="post-text">
          <b>Well, my top priority</b>   is to have immediate access to my total assets at any given time. To accomplish this,
            I devised an Excel spreadsheet and filled in the quantity of each currency I possess. Once I obtained the
            missing values, my total capital was at my fingertips in a flash.
        </p>
        <br>


        <p class="post-text">
          <b>Thankfully, there's</b>   a website that manages cryptocurrency prices and acts as a valuable partner for anyone
            keen on the world of cryptocurrencies: Coinmarketcap. They offer an API that's entirely free in the "free"
            version, enabling users to access current prices of numerous cryptocurrencies. All it takes is to create a
            key and use the code provided in this article.
        </p>
        <br>
        <p class="post-text">
          <b>Let's start with</b>   the key. First, you need to go <a href="https://coinmarketcap.com/api/" target="_blank">
                <b>here</b> </a> and create an account. Once you've done that, click on
            the "GET YOUR API KEY NOW" button. After your key is issued, copy it to a txt file and proceed.
        </p>

        <img src="../post-images/coinmarketcap2.webp" class="post-img" alt="">

        <p class="post-text">
         <b>Alright, let's</b>    shift our focus to the code. To retrieve the present price for every cryptocurrency, you'll
            need to provide three essential pieces of information.
        </p>
        <p class="post-text">
            <b>1. headers.</b> Here, you input the API key you just obtained, along with the file format you want the
            data to be returned in (JSON).
        </p>
        <p class="post-text">
            <b>2. params.</b> Here, you'll enter the symbols you're interested in and the currency pair. Since I've made
            all my purchases
            in EUR, I'll select that. As for the symbols, you'll go to <a
                href="https://coinmarketcap.com/all/views/all/" target="_blank"><b>this address</b></a> and select the
            ones you want to
            track.
        </p>
        <p class="post-text">
            <b>3. url.</b> This is standard - it's the API address
            'https://pro-api.coinmarketcap.
            com/v1/
            cryptocurrency/quotes/latest'
        </p>
        <br>

        <p class="post-text">
         <b>The request you</b>    make will return a JSON file in the following format:
        </p>

        <pre class="post-text">
            <code>
                {'data': {'BTC': {'circulating_supply': 18867481,
                  'cmc_rank': 1,
                  'date_added': '2013-04-28T00:00:00.000Z',
                  'id': 1,
                  'is_active': 1,
                  'is_fiat': 0,
                  'last_updated': '2021-11-08T15:27:02.000Z',
                  'max_supply': 21000000,
                  'name': 'Bitcoin',
                  'num_market_pairs': 8297,
                  'platform': None,
                  'quote': {'EUR': {'fully_diluted_market_cap': 1189612564080.0137,
                                    'last_updated': '2021-11-08T15:27:34.000Z',
                                    'market_cap': 1068809164292.4241,
                                    'market_cap_dominance': 43.2794,
                                    'percent_change_1h': 0.0415769,
                                    'percent_change_24h': 5.45204024,
                                    'percent_change_30d': 19.07865819,
                                    'percent_change_60d': 40.03057059,
                                    'percent_change_7d': 5.11858583,
                                    'percent_change_90d': 45.00142545,
                                    'price': 56648.217337143426,
                                    'volume_24h': 30440975711.61554,
                                    'volume_change_24h': 40.8923}},
                  'slug': 'bitcoin',
                  'symbol': 'BTC',
            </code>
        </pre>





        <p class="post-text">
          <b>So, you need</b>   to find the key value called "price" and retrieve its value, just like you would with any
            dictionary.  Of course, you can retrieve any useful information, such as the 24-hour or 90-day change, and so on.
        </p>
        <br>

        <p class="post-text">
          <b>Below is the</b>   complete code. You need to change the API key and the location where you want to save the Excel
            file. In this example, in addition to the current value, I am also retrieving the 24-hour change for the 7+1
            cryptocurrencies I am tracking.
        </p>
        <br>

        <p class="post-text">
            <b>*** Please note that this is not investment or financial advice. For investments, you should do your own
                research and follow the
                instructions of certified individuals.</b>
        </p>

        <pre class="code post-text">
            <code>
                import requests
                from datetime import datetime
                from openpyxl import load_workbook
                import pprint
                
                # Get data
                
                headers = {
                    'X-CMC_PRO_API_KEY': 'YOUR API KEY',
                    'Accepts': 'application/json'
                }
                
                params = {
                    'symbol': 'doge,matic,xlm,vet,trx,shib,hot,btc',
                    'convert': 'EUR'
                }
                
                url = 'https://pro-api.coinmarketcap.com/v1/cryptocurrency/quotes/latest'
                
                prices = requests.get(url, params=params, headers=headers).json()
                # pprint.pprint(prices) # εδώ μπορούμε να δούμε τι τυπώνει το request
                
                doge = prices['data']['DOGE']['quote']['EUR']['price']
                matic = prices['data']['MATIC']['quote']['EUR']['price']
                xlm = prices['data']['XLM']['quote']['EUR']['price']
                vet = prices['data']['VET']['quote']['EUR']['price']
                trx = prices['data']['TRX']['quote']['EUR']['price']
                shib = prices['data']['SHIB']['quote']['EUR']['price']
                hot = prices['data']['HOT']['quote']['EUR']['price']
                
                doge_perc_change = prices['data']['DOGE']['quote']['EUR']['percent_change_24h']
                matic_perc_change = prices['data']['MATIC']['quote']['EUR']['percent_change_24h']
                xlm_perc_change = prices['data']['XLM']['quote']['EUR']['percent_change_24h']
                vet_perc_change = prices['data']['VET']['quote']['EUR']['percent_change_24h']
                trx_perc_change = prices['data']['TRX']['quote']['EUR']['percent_change_24h']
                shib_perc_change = prices['data']['SHIB']['quote']['EUR']['percent_change_24h']
                hot_perc_change = prices['data']['HOT']['quote']['EUR']['percent_change_24h']
                btc_perc_change = prices['data']['BTC']['quote']['EUR']['percent_change_24h']
                
                # Write to excel sheet
                
                book = load_workbook(r'YOUR EXCEL DESTINATION ON DISK') # π.χ 'E:\My_files' κλπ
                sheet = book.active
                
                sheet['c2'] = trx
                sheet['c3'] = xlm
                sheet['c4'] = hot
                sheet['c5'] = vet
                sheet['c6'] = shib
                sheet['c7'] = matic
                sheet['c8'] = doge
                
                sheet['d2'] = trx_perc_change/100
                sheet['d3'] = xlm_perc_change/100
                sheet['d4'] = hot_perc_change/100
                sheet['d5'] = vet_perc_change/100
                sheet['d6'] = shib_perc_change/100
                sheet['d7'] = matic_perc_change/100
                sheet['d8'] = doge_perc_change/100
                sheet['d10'] = btc_perc_change/100
                
                now = datetime.now()
                time = now.strftime("%H:%M:%S")
                day = now.strftime('%d/%m/%Y')
                sheet['b15'] = time
                sheet['b17'] = day
                
                book.save(r'YOUR EXCEL DESTINATION ON DISK')
                book.close()
                print('\nBook was successfully updated!..')
            </code>
        </pre>









    </div>


    <!--Footer-->
    <div id="footer-placeholder">

    </div>

    <script>
        $(function () {
            $("#footer-placeholder").load("../footer.html");
        });
    </script>
    <!--end of Footer-->


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>

</body>

</html>